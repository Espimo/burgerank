# ğŸ“Š BURGERANK - DOCUMENTO 360Â° DEL PROYECTO

## ğŸ¯ RESUMEN EJECUTIVO

**BurgeRank** es una plataforma web comunitaria de ranking y valoraciÃ³n de hamburguesas que conecta a entusiastas de la comida con los mejores restaurantes, mientras genera ingresos mediante enlaces de afiliaciÃ³n y descuentos exclusivos.

---

## 1. VISIÃ“N GENERAL DEL NEGOCIO

### 1.1 Propuesta de Valor

BurgeRank resuelve tres problemas clave:

1. **Para Consumidores**: Imposibilidad de encontrar hamburguesas de calidad basÃ¡ndose en opiniones fiables y criterios objetivos
2. **Para Restaurantes**: Falta de visibilidad y capacidad de atraer clientes cualificados
3. **Para la Plataforma**: MonetizaciÃ³n sin comprometer la experiencia del usuario

### 1.2 MisiÃ³n

Crear la comunidad definitiva de amantes de las hamburguesas en EspaÃ±a, proporcionando un ranking transparente, basado en algoritmos avanzados y opiniones verificadas, mientras generamos valor para usuarios, restaurantes y la plataforma.

---

## 2. BUSINESS MODEL CANVAS

### ğŸ“¦ SEGMENTOS DE CLIENTES

**Usuarios Finales (B2C)**
- **Burger Fans**: Consumidores casuales que buscan recomendaciones (0-100 puntos)
- **Burger Lovers**: Entusiastas activos que valoran regularmente (101-300 puntos)
- **Burger Obsessed**: CrÃ­ticos expertos con alto compromiso (+300 puntos)

**Restaurantes (B2B)**
- Restaurantes independientes de hamburguesas
- Cadenas pequeÃ±as/medianas buscando visibilidad
- Nuevos establecimientos que necesitan tracciÃ³n inicial

**Plataformas de Delivery (B2B2C)**
- Uber Eats, Glovo, Just Eat, Deliveroo
- Plataformas de reservas (El Tenedor)

### ğŸ’° FUENTES DE INGRESOS

**Fase 1 - MonetizaciÃ³n Actual (Implementada)**
1. **AfiliaciÃ³n por Click**: 
   - Comisiones por cada pedido generado via enlaces de afiliaciÃ³n
   - Estimado: â‚¬0.50 - â‚¬3.00 por conversiÃ³n
   - ProyecciÃ³n: 10,000 clicks/mes â†’ â‚¬5,000-â‚¬15,000/mes

2. **Descuentos Patrocinados**:
   - Restaurantes pagan por destacar descuentos exclusivos
   - â‚¬50-â‚¬200/mes por restaurante
   - ProyecciÃ³n: 20 restaurantes â†’ â‚¬1,000-â‚¬4,000/mes

**Fase 2 - Futuro (No implementada)**
3. **MembresÃ­a Premium** (â‚¬4.99/mes):
   - Sin publicidad
   - Acceso anticipado a nuevos restaurantes
   - Descuentos exclusivos adicionales
   - AnÃ¡lisis avanzado de preferencias

4. **Perfiles Premium para Restaurantes** (â‚¬99-â‚¬299/mes):
   - PosiciÃ³n destacada en bÃºsquedas
   - EstadÃ­sticas avanzadas
   - GestiÃ³n de promociones
   - Respuesta a valoraciones

5. **Publicidad Display**:
   - Banners nativos (futuro)
   - Contenido patrocinado

### ğŸ PROPUESTAS DE VALOR

**Para Usuarios**
- âœ… Ranking algorÃ­tmico avanzado (Bayesian + Wilson Score)
- âœ… Carousel de burgers destacadas (lo mejor curado manualmente)
- âœ… Sistema de gamificaciÃ³n (puntos, badges, categorÃ­as)
- âœ… Valoraciones granulares (pan, carne, toppings, salsa)
- âœ… Descuentos exclusivos de la comunidad
- âœ… Historial personal y top 3 hamburguesas

**Para Restaurantes**
- ğŸ”— TrÃ¡fico cualificado de comensales interesados
- ğŸŒŸ Posibilidad de aparecer en carousel de destacados (mÃ¡xima visibilidad)
- ğŸ“Š Visibilidad basada en calidad real, no en pago
- ğŸ¯ SegmentaciÃ³n por ciudad y preferencias
- ğŸ’¬ Feedback directo de clientes

**Para Plataformas de Delivery**
- ğŸš€ Conversiones de alta intenciÃ³n
- ğŸ“ˆ TrÃ¡fico orgÃ¡nico desde una comunidad comprometida

### ğŸ¤ CANALES

**AdquisiciÃ³n de Usuarios**
1. **OrgÃ¡nico**: SEO en bÃºsquedas locales ("mejores hamburguesas Madrid")
2. **Redes Sociales**: Instagram, TikTok (contenido de hamburguesas)
3. **Referidos**: Sistema de compartir (implementado con ShareButton)
4. **Partnerships**: Colaboraciones con foodbloggers e influencers

**DistribuciÃ³n**
- Web responsive (mobile-first)
- PWA (Progressive Web App) - futuro

### ğŸ‘¥ RELACIONES CON CLIENTES

**Usuarios**
- Comunidad self-service
- Notificaciones push de nuevas hamburguesas/logros
- GamificaciÃ³n para retenciÃ³n (badges, niveles)

**Restaurantes**
- Onboarding asistido (panel de admin)
- Dashboard de estadÃ­sticas
- Soporte directo

### ğŸ’ª RECURSOS CLAVE

**TecnolÃ³gicos**
- Next.js 16 + React 19 (frontend)
- Supabase + PostgreSQL (backend/BDD)
- Vercel (hosting y CI/CD)
- Sistema de algoritmos de ranking propietario

**Humanos**
- Desarrollador full-stack (tÃº)
- Moderadores de contenido (futuro)
- Community manager (futuro)

**Datos**
- Base de datos de 120+ hamburguesas
- MÃºltiples ciudades (Madrid, Barcelona, Valencia, Sevilla, Bilbao)
- Valoraciones verificadas con tickets

### ğŸ”§ ACTIVIDADES CLAVE

1. **Desarrollo y Mantenimiento**: Mejora continua de la plataforma
2. **CuraciÃ³n de Contenido**: AprobaciÃ³n de restaurantes y hamburguesas
3. **GestiÃ³n de Afiliaciones**: NegociaciÃ³n con plataformas de delivery
4. **Growth Marketing**: AdquisiciÃ³n de usuarios y restaurantes
5. **ModeraciÃ³n**: Control de calidad de valoraciones

### ğŸ¤ SOCIOS CLAVE

**Actuales**
- Uber Eats, Glovo, Just Eat, Deliveroo (afiliaciÃ³n)
- El Tenedor (reservas)

**Futuros**
- Foodbloggers e influencers gastronÃ³micos
- Asociaciones de restauradores
- Medios gastronÃ³micos

### ğŸ’¸ ESTRUCTURA DE COSTES

**Costes Fijos**
- Hosting Vercel: â‚¬0-â‚¬20/mes (escala con uso)
- Supabase: â‚¬0-â‚¬25/mes (escala con uso)
- Dominio: â‚¬12/aÃ±o

**Costes Variables**
- Comisiones de afiliaciÃ³n pagadas: 0% (cobras comisiÃ³n, no pagas)
- Marketing digital: Variable segÃºn fase de crecimiento
- Soporte al cliente: Escala con usuarios

**Costes Futuros**
- Equipo de moderaciÃ³n
- Marketing y publicidad
- Infraestructura adicional

---

## 3. ARQUITECTURA TÃ‰CNICA

### 3.1 Stack TecnolÃ³gico

```
Frontend:
â”œâ”€â”€ Next.js 16 (App Router)
â”œâ”€â”€ React 19 (Server Components)
â”œâ”€â”€ TypeScript 5
â”œâ”€â”€ Tailwind CSS 4
â”œâ”€â”€ Framer Motion (animaciones)
â””â”€â”€ Radix UI (componentes accesibles)

Backend:
â”œâ”€â”€ Supabase
â”‚   â”œâ”€â”€ PostgreSQL (base de datos)
â”‚   â”œâ”€â”€ Auth (autenticaciÃ³n)
â”‚   â”œâ”€â”€ RLS (Row Level Security)
â”‚   â””â”€â”€ Edge Functions
â””â”€â”€ Next.js API Routes

Deployment:
â”œâ”€â”€ Vercel (hosting + CI/CD automÃ¡tico)
â”œâ”€â”€ GitHub (control de versiones)
â””â”€â”€ Supabase Cloud (BaaS)

Libraries Clave:
â”œâ”€â”€ @supabase/supabase-js (cliente)
â”œâ”€â”€ zustand (gestiÃ³n de estado global)
â”œâ”€â”€ react-hook-form + zod (formularios + validaciÃ³n)
â”œâ”€â”€ recharts (grÃ¡ficos)
â””â”€â”€ date-fns (manejo de fechas)
```

### 3.2 Modelo de Datos

```sql
TABLAS PRINCIPALES:

users (Usuarios)
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ username (VARCHAR, UNIQUE)
â”œâ”€â”€ email (VARCHAR, UNIQUE)
â”œâ”€â”€ points (INT) â†’ puntos acumulados
â”œâ”€â”€ category (VARCHAR) â†’ Burger Fan | Lover | Obsessed
â”œâ”€â”€ is_admin (BOOLEAN)
â””â”€â”€ public_profile (BOOLEAN)

cities (Ciudades)
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ name (VARCHAR, UNIQUE)
â””â”€â”€ country (VARCHAR)

restaurants (Restaurantes)
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ name (VARCHAR)
â”œâ”€â”€ city_id (UUID, FK â†’ cities)
â”œâ”€â”€ address, phone, hours
â”œâ”€â”€ average_rating (DECIMAL)
â”œâ”€â”€ total_ratings (INT)
â”œâ”€â”€ status (VARCHAR) â†’ pending | approved | rejected
â”œâ”€â”€ delivery_url, reservation_url, website
â””â”€â”€ banner_url, logo_url

burgers (Hamburguesas)
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ name (VARCHAR)
â”œâ”€â”€ restaurant_id (UUID, FK â†’ restaurants)
â”œâ”€â”€ city_id (UUID, FK â†’ cities)
â”œâ”€â”€ description (TEXT)
â”œâ”€â”€ image_url (TEXT)
â”œâ”€â”€ average_rating (DECIMAL)
â”œâ”€â”€ total_ratings (INT)
â”œâ”€â”€ ranking_position (INT) â†’ posiciÃ³n en el ranking
â”œâ”€â”€ ranking_score (DECIMAL) â†’ puntuaciÃ³n calculada
â”œâ”€â”€ bayesian_score (DECIMAL) â†’ Bayesian Average
â”œâ”€â”€ wilson_score (DECIMAL) â†’ Wilson Score Lower Bound
â”œâ”€â”€ is_in_ranking (BOOLEAN)
â”œâ”€â”€ is_featured (BOOLEAN) â†’ si estÃ¡ en el carousel destacado (mÃ¡ximo 3)
â”œâ”€â”€ featured_order (INT) â†’ posiciÃ³n en carousel (1, 2, 3 | NULL si no featured)
â”œâ”€â”€ tags (TEXT[]) â†’ array de etiquetas
â”œâ”€â”€ type (VARCHAR) â†’ premium | clÃ¡sica | doble | vegana
â””â”€â”€ status (VARCHAR) â†’ pending | approved | rejected

ratings (Valoraciones)
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ user_id (UUID, FK â†’ users)
â”œâ”€â”€ burger_id (UUID, FK â†’ burgers)
â”œâ”€â”€ overall_rating (INT 1-5) â†’ calificaciÃ³n general
â”œâ”€â”€ pan_rating (INT 1-3)
â”œâ”€â”€ carne_rating (INT 1-3)
â”œâ”€â”€ toppings_rating (INT 1-3)
â”œâ”€â”€ salsa_rating (INT 1-3)
â”œâ”€â”€ price (DECIMAL)
â”œâ”€â”€ comment (TEXT)
â”œâ”€â”€ has_ticket (BOOLEAN) â†’ valoraciÃ³n verificada
â”œâ”€â”€ ticket_url (TEXT)
â”œâ”€â”€ consumption_type (VARCHAR) â†’ local | delivery
â”œâ”€â”€ appetizers (TEXT[]) â†’ fries, nachos, chicken, rings
â”œâ”€â”€ points_awarded (INT) â†’ puntos ganados por esta valoraciÃ³n
â””â”€â”€ UNIQUE(user_id, burger_id) â†’ 1 valoraciÃ³n por usuario/burger

badges (Insignias)
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ name (VARCHAR, UNIQUE)
â”œâ”€â”€ description (TEXT)
â”œâ”€â”€ emoji (VARCHAR)
â”œâ”€â”€ requirement_type (VARCHAR) â†’ first_rating | total_ratings | cities_visited | average_rating
â””â”€â”€ requirement_value (INT)

user_badges (Insignias desbloqueadas)
â”œâ”€â”€ user_id (UUID, FK â†’ users)
â”œâ”€â”€ badge_id (UUID, FK â†’ badges)
â”œâ”€â”€ unlocked_at (TIMESTAMP)
â””â”€â”€ UNIQUE(user_id, badge_id)

rewards (Recompensas canjeables)
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ name (VARCHAR)
â”œâ”€â”€ description (TEXT)
â”œâ”€â”€ emoji (VARCHAR)
â””â”€â”€ cost_points (INT) â†’ puntos necesarios

user_rewards (Recompensas canjeadas)
â”œâ”€â”€ user_id (UUID, FK â†’ users)
â”œâ”€â”€ reward_id (UUID, FK â†’ rewards)
â”œâ”€â”€ redeemed_at (TIMESTAMP)
â””â”€â”€ created_at (TIMESTAMP)

notifications (Notificaciones)
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ user_id (UUID, FK â†’ users)
â”œâ”€â”€ title (VARCHAR)
â”œâ”€â”€ description (TEXT)
â”œâ”€â”€ type (VARCHAR) â†’ level_up | badge_unlocked | new_burger
â”œâ”€â”€ icon_emoji (VARCHAR)
â””â”€â”€ is_read (BOOLEAN)

-- MONETIZACIÃ“N (Fase 1)

affiliate_platforms (Plataformas de afiliaciÃ³n)
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ name (VARCHAR, UNIQUE) â†’ uber_eats | glovo | just_eat
â”œâ”€â”€ display_name (VARCHAR) â†’ "Uber Eats"
â”œâ”€â”€ type (VARCHAR) â†’ delivery | reservation | direct
â”œâ”€â”€ icon_emoji (VARCHAR)
â”œâ”€â”€ default_priority (INT) â†’ menor = mayor prioridad
â”œâ”€â”€ cta_text (VARCHAR) â†’ "Pedir en Uber Eats"
â”œâ”€â”€ color (VARCHAR) â†’ color del botÃ³n
â””â”€â”€ is_active (BOOLEAN)

restaurant_affiliate_links (Links de afiliaciÃ³n)
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ restaurant_id (UUID, FK â†’ restaurants)
â”œâ”€â”€ platform_id (UUID, FK â†’ affiliate_platforms)
â”œâ”€â”€ affiliate_url (TEXT) â†’ URL con parÃ¡metros de tracking
â”œâ”€â”€ custom_priority (INT) â†’ sobrescribe default_priority
â”œâ”€â”€ custom_cta_text (VARCHAR)
â”œâ”€â”€ is_active (BOOLEAN)
â”œâ”€â”€ commission_rate (DECIMAL)
â””â”€â”€ UNIQUE(restaurant_id, platform_id)

restaurant_discounts (Descuentos activos)
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ restaurant_id (UUID, FK â†’ restaurants)
â”œâ”€â”€ title (VARCHAR) â†’ "10% exclusivo BurgeRank"
â”œâ”€â”€ description (TEXT)
â”œâ”€â”€ discount_code (VARCHAR) â†’ "BURGERANK10"
â”œâ”€â”€ discount_type (VARCHAR) â†’ percentage | fixed_amount | free_delivery
â”œâ”€â”€ discount_value (DECIMAL)
â”œâ”€â”€ valid_from (TIMESTAMP)
â”œâ”€â”€ valid_until (TIMESTAMP)
â”œâ”€â”€ platform_id (UUID, FK â†’ affiliate_platforms)
â”œâ”€â”€ is_active (BOOLEAN)
â””â”€â”€ is_exclusive (BOOLEAN) â†’ exclusivo de BurgeRank

affiliate_clicks (Tracking de clicks)
â”œâ”€â”€ id (UUID, PK)
â”œâ”€â”€ restaurant_id (UUID, FK â†’ restaurants)
â”œâ”€â”€ platform_id (UUID, FK â†’ affiliate_platforms)
â”œâ”€â”€ affiliate_link_id (UUID, FK â†’ restaurant_affiliate_links)
â”œâ”€â”€ discount_id (UUID, FK â†’ restaurant_discounts)
â”œâ”€â”€ user_id (UUID, FK â†’ users, NULLABLE)
â”œâ”€â”€ source_page (VARCHAR) â†’ ranking | restaurant | burger_detail
â”œâ”€â”€ source_burger_id (UUID, FK â†’ burgers, NULLABLE)
â”œâ”€â”€ session_id (VARCHAR) â†’ para agrupar clicks de misma sesiÃ³n
â””â”€â”€ clicked_at (TIMESTAMP)
```

### 3.3 Algoritmo de Ranking Avanzado

El sistema de ranking utiliza una combinaciÃ³n ponderada de tres algoritmos:

```typescript
Ranking Score = (Bayesian Ã— 0.50) + (Wilson Ã— 0.30) + (Average Ã— 0.20)

// 1. Bayesian Average (evita burgers con pocas valoraciones)
Bayesian = (C Ã— m + n Ã— R) / (C + n)
donde:
  C = confidence threshold (25 valoraciones)
  m = rating promedio global (ej: 4.2)
  n = nÃºmero de valoraciones de esta burger
  R = rating promedio de esta burger

// 2. Wilson Score Lower Bound (confianza estadÃ­stica 95%)
Wilson = lÃ­mite inferior del intervalo de confianza
  - Considera % de ratings positivos (4-5 estrellas)
  - Penaliza inconsistencia
  - FÃ³rmula matemÃ¡tica compleja (ver ADD_RANKING_SYSTEM.sql)

// 3. Average Rating (peso menor, 20%)
Average = promedio simple de overall_rating

FACTORES ADICIONALES:
- Verification Factor: +10% si >50% tienen ticket
- Novelty Boost: +10% si es nueva (< 30 dÃ­as)
- Anti-gaming: detecta patrones sospechosos
```

**Ventajas del sistema**:
- âœ… Las burgers con pocas valoraciones no dominan el ranking
- âœ… Premia consistencia, no solo valoraciones altas
- âœ… Protege contra manipulaciÃ³n y fake reviews
- âœ… Promueve nuevas hamburguesas temporalmente
- âœ… Totalmente transparente y replicable

---

## 4. WORKFLOW DE USUARIO

### 4.1 Flujo de Registro y GamificaciÃ³n

```
1. Usuario Nuevo (No Registrado)
   â”œâ”€â”€ Ve ranking completo (lectura)
   â”œâ”€â”€ Intenta valorar â†’ Modal "RegÃ­strate para valorar"
   â””â”€â”€ Click "Valorar" â†’ RedirecciÃ³n a /auth/signup

2. Registro
   â”œâ”€â”€ Email + Password + Username
   â”œâ”€â”€ VerificaciÃ³n de email (link en email)
   â”œâ”€â”€ Auto-creaciÃ³n de perfil en tabla users
   â””â”€â”€ AsignaciÃ³n de categorÃ­a inicial: "Burger Fan" (0 puntos)

3. Primera ValoraciÃ³n
   â”œâ”€â”€ Wizard de 5 pasos
   â”œâ”€â”€ Puntos ganados: 10-15 base + bonos
   â”‚   â”œâ”€â”€ +5 si sube ticket (verificada)
   â”‚   â”œâ”€â”€ +3 si aÃ±ade foto
   â”‚   â””â”€â”€ +2 si escribe comentario >50 caracteres
   â”œâ”€â”€ Desbloqueo de Badge "Primer Rating" â­
   â””â”€â”€ NotificaciÃ³n: "Â¡Has ganado 15 puntos!"

4. ProgresiÃ³n de CategorÃ­a
   â”œâ”€â”€ 0-100 puntos: "Burger Fan" ğŸ”
   â”œâ”€â”€ 101-300 puntos: "Burger Lover" â¤ï¸
   â””â”€â”€ 301+: "Burger Obsessed" ğŸ”¥

5. Sistema de Badges (7 disponibles)
   â”œâ”€â”€ Primer Rating (1 valoraciÃ³n)
   â”œâ”€â”€ CrÃ­tico Ardiente (10 valoraciones)
   â”œâ”€â”€ Maestro de Sabores (25 valoraciones)
   â”œâ”€â”€ Coleccionista (50 valoraciones)
   â”œâ”€â”€ Explorador de Ciudades (5 ciudades)
   â”œâ”€â”€ Paladar Exigente (promedio 4.5+)
   â””â”€â”€ CrÃ­tico Leyenda (100 valoraciones)

6. Sistema de Recompensas (5 tipos)
   â”œâ”€â”€ 10% Descuento (50 puntos)
   â”œâ”€â”€ Bebida Gratis (75 puntos)
   â”œâ”€â”€ Aperitivo Gratis (100 puntos)
   â”œâ”€â”€ Hamburguesa Gratis (150 puntos)
   â””â”€â”€ 50% Descuento (200 puntos)
```

### 4.2 Wizard de ValoraciÃ³n (5 Pasos)

```
/rate

PASO 0: CONTEXTO
â”œâ”€â”€ Â¿DÃ³nde comiste? â†’ local | delivery
â”œâ”€â”€ Â¿QuÃ© pediste de aperitivo?
â”‚   â””â”€â”€ Checkboxes: Papas | Nachos | Alitas | Aros de cebolla | Nada
â””â”€â”€ [Siguiente â†’]

PASO 1: SELECCIONAR HAMBURGUESA
â”œâ”€â”€ Buscador inteligente (SmartSearch)
â”‚   â”œâ”€â”€ Filtro por nombre de burger
â”‚   â”œâ”€â”€ Filtro por restaurante
â”‚   â””â”€â”€ Filtro por ciudad
â”œâ”€â”€ Grid de cards de burgers
â”‚   â”œâ”€â”€ Imagen (si existe)
â”‚   â”œâ”€â”€ Nombre
â”‚   â”œâ”€â”€ Restaurante
â”‚   â”œâ”€â”€ Rating actual
â”‚   â””â”€â”€ [Seleccionar]
â”œâ”€â”€ BotÃ³n "No encuentro mi burger"
â”‚   â””â”€â”€ Modal para aÃ±adir nueva burger (pending â†’ admin approval)
â””â”€â”€ [Siguiente â†’]

PASO 2: VALORAR COMPONENTES (granular)
â”œâ”€â”€ Overall Rating (1-5 estrellas) â†’ grande, principal
â”œâ”€â”€ Pan (1-3 estrellas) â†’ ğŸ¥–
â”œâ”€â”€ Carne (1-3 estrellas) â†’ ğŸ¥©
â”œâ”€â”€ Toppings (1-3 estrellas) â†’ ğŸ§€ğŸ¥“ğŸ¥¬
â”œâ”€â”€ Salsa (1-3 estrellas) â†’ ğŸ¯
â””â”€â”€ [Siguiente â†’]

PASO 3: DETALLES ADICIONALES
â”œâ”€â”€ Precio (â‚¬) â†’ input numÃ©rico
â”œâ”€â”€ Comentario (opcional) â†’ textarea
â”œâ”€â”€ Â¿Tienes el ticket?
â”‚   â”œâ”€â”€ Checkbox "SÃ­, tengo ticket"
â”‚   â””â”€â”€ Si sÃ­ â†’ +5 puntos bonus (verificaciÃ³n)
â””â”€â”€ [Siguiente â†’]

PASO 4: CONFIRMACIÃ“N Y Ã‰XITO
â”œâ”€â”€ Resumen visual de la valoraciÃ³n
â”œâ”€â”€ AnimaciÃ³n de Ã©xito
â”œâ”€â”€ Mostrar puntos ganados: "+15 puntos ğŸ‰"
â”œâ”€â”€ Mostrar badges desbloqueados (si hay)
â”œâ”€â”€ Botones:
â”‚   â”œâ”€â”€ [Ver en Ranking]
â”‚   â”œâ”€â”€ [Valorar Otra]
â”‚   â””â”€â”€ [Ir a Perfil]
â””â”€â”€ Auto-redirecciÃ³n a /ranking despuÃ©s de 5 segundos
```

### 4.3 NavegaciÃ³n Principal (5 secciones)

```
TOP BAR (Todas las pÃ¡ginas)
â”œâ”€â”€ Logo "BurgeRank" (link a /ranking)
â”œâ”€â”€ Notificaciones (campana) â†’ Panel lateral
â”œâ”€â”€ Perfil (avatar) â†’ Menu dropdown
â””â”€â”€ Hamburger Menu â†’ Sidebar

BOTTOM NAV (Mobile)
â”œâ”€â”€ ğŸ† Ranking â†’ /ranking
â”œâ”€â”€ â­ Valorar â†’ /rate
â”œâ”€â”€ ğŸ‘¤ Perfil â†’ /profile
â””â”€â”€ â„¹ï¸ Info â†’ /about

SIDEBAR (Desktop/Tablet)
â”œâ”€â”€ Perfil rÃ¡pido (avatar, nombre, puntos)
â”œâ”€â”€ ğŸ† Ver Ranking
â”œâ”€â”€ â­ Valorar Burger
â”œâ”€â”€ ğŸ‘¤ Mi Perfil
â”œâ”€â”€ â„¹ï¸ Acerca de
â”œâ”€â”€ âš™ï¸ ConfiguraciÃ³n
â”œâ”€â”€ (Si admin) ğŸ”§ Panel Admin
â””â”€â”€ ğŸšª Cerrar SesiÃ³n
```

---

## 5. PÃGINAS PRINCIPALES

### 5.1 `/ranking` - Ranking Principal

**PropÃ³sito**: Mostrar todas las hamburguesas ordenadas por ranking_score

**Componentes**:

#### ğŸŒŸ Carousel de Destacados (Featured)
- **UbicaciÃ³n**: Parte superior de la pÃ¡gina, antes del ranking
- **Contenido**: 3 hamburguesas destacadas seleccionadas manualmente desde el panel admin
- **CaracterÃ­sticas**:
  - Slider automÃ¡tico con rotaciÃ³n cada 5 segundos
  - NavegaciÃ³n manual (flechas izq/der o dots)
  - Cards grandes con:
    - Imagen principal de la burger
    - Badge especial "DESTACADA" ğŸŒŸ
    - Nombre de la burger
    - Restaurante
    - Rating con estrellas
    - BotÃ³n CTA "Ver mÃ¡s"
  - Animaciones suaves de transiciÃ³n
  - Responsive (1 slide en mobile, 3 en desktop)
- **GestiÃ³n**: Controlado desde panel admin (ver secciÃ³n 5.6)
- **Criterio de selecciÃ³n**: Administrador elige manualmente las 3 burgers mÃ¡s interesantes (nuevas, populares, promociones especiales)
- **Order**: Campo `featured_order` determina la posiciÃ³n (1, 2, 3)

#### ğŸ” Filtros:
  - Ciudad (dropdown: Madrid, Barcelona, Valencia, Sevilla, Bilbao, Todas)
  - Tipo (dropdown: Premium, ClÃ¡sica, Doble, Vegana)
  - BÃºsqueda por texto (SmartSearch)
  - Ordenamiento: Ranking | Nuevas | Tendencias
  - Filtros avanzados (desplegable)
- **Grid de Burgers** (3 columnas desktop, 1 mobile):
  - Card por burger con imagen, posiciÃ³n, rating, tags, botÃ³n "Pedir"
- **PaginaciÃ³n**: Load more / Infinite scroll

**Estado Actual**: âœ… Totalmente funcional

### 5.2 `/rate` - Wizard de ValoraciÃ³n

**PropÃ³sito**: Proceso guiado de 5 pasos para valorar una hamburguesa

**Flujo**: Ver secciÃ³n 4.2

**CaracterÃ­sticas**:
- Progress bar y navegaciÃ³n
- ValidaciÃ³n por paso
- Guardado automÃ¡tico en borrador
- Animaciones entre pasos
- Responsive (mobile-first)

**Estado Actual**: âœ… Totalmente funcional

### 5.3 `/profile` - Perfil de Usuario

**PropÃ³sito**: Dashboard personal del usuario

**Secciones**:
- Header del perfil
- Stats card (puntos, categorÃ­a, badges)
- Badges (8 slots)
- Recompensas canjeables
- Top 3 personal
- Ãšltimas valoraciones
- ConfiguraciÃ³n

**Estado Actual**: âœ… Totalmente funcional

### 5.4 `/restaurante/[nombre]` - PÃ¡gina de Restaurante

**PropÃ³sito**: PÃ¡gina de detalle de un restaurante con todas sus hamburguesas

**Secciones**:
- Hero banner
- InformaciÃ³n de contacto
- CTA de afiliaciÃ³n sticky (AffiliateCTA)
- Hamburguesas del restaurante
- Promociones activas
- Valoraciones recientes

**Estado Actual**: âœ… Totalmente funcional con monetizaciÃ³n

### 5.5 `/about` - Acerca de

**PropÃ³sito**: InformaciÃ³n sobre la plataforma y FAQs

**Estado Actual**: âœ… Totalmente funcional

### 5.6 `/admin` - Panel de AdministraciÃ³n

**PropÃ³sito**: GestiÃ³n completa de la plataforma (solo admins)

**Secciones**:

1. **Dashboard**
   - Stats generales (total burgers, restaurantes, usuarios, valoraciones)
   - Promociones activas
   - Aprobaciones pendientes
   - Widget de preview del carousel featured actual

2. **GestiÃ³n de Burgers**
   - CRUD completo de hamburguesas
   - AprobaciÃ³n de burgers pendientes
   - EdiciÃ³n de is_in_ranking

3. **GestiÃ³n de Restaurantes**
   - CRUD completo de restaurantes
   - GestiÃ³n de ubicaciones
   - ConfiguraciÃ³n de affiliate links

4. **GestiÃ³n de Usuarios**
   - Lista de usuarios
   - Cambiar roles (admin/user)
   - GestiÃ³n de puntos y badges

5. **GestiÃ³n de Promociones**
   - CRUD de promociones
   - Configurar descuentos por restaurante

6. **RevisiÃ³n de Valoraciones**
   - Moderar valoraciones reportadas
   - Eliminar valoraciones fraudulentas

7. **Featured Burgers** â­ (Carousel del Ranking)
   - **PropÃ³sito**: Gestionar las 3 burgers destacadas del carousel principal
   - **Interfaz**:
     - Vista previa en tiempo real del carousel
     - 3 slots numerados (PosiciÃ³n 1, 2, 3)
     - Cada slot muestra:
       - Miniatura de la burger actual
       - Nombre y restaurante
       - Rating
       - Botones "Cambiar" / "Quitar"
   - **Funcionalidades**:
     - **Selector de burgers**: Modal con bÃºsqueda y filtros
     - **Drag & drop**: Reordenar las 3 posiciones arrastrando
     - **Vista previa en tiempo real**: Ver cÃ³mo se verÃ¡ en el carousel pÃºblico
     - **Toggle activar/desactivar**: Mostrar/ocultar el carousel completo
   - **LÃ³gica**:
     - Al seleccionar burger â†’ `is_featured = true`, asignar `featured_order` (1, 2 o 3)
     - Al quitar â†’ `is_featured = false`, `featured_order = null`
     - Si hay menos de 3, el carousel se adapta automÃ¡ticamente
   - **Recomendaciones del sistema**:
     - Burgers populares sin destacar
     - Burgers nuevas (Ãºltimos 7 dÃ­as)
     - Burgers con promociones activas
     - Burgers con mayor crecimiento en ratings

8. **Pendientes de aprobaciÃ³n**
   - Burgers nuevas aÃ±adidas por usuarios
   - Restaurantes nuevos
   - Valoraciones reportadas

**Estado Actual**: âœ… Totalmente funcional

### 5.7 `/auth/*` - AutenticaciÃ³n

**PÃ¡ginas**:
- `/auth/signin` - Inicio de sesiÃ³n
- `/auth/signup` - Registro
- `/auth/verify-email` - VerificaciÃ³n de email
- `/auth/reset-password` - Recuperar contraseÃ±a

**Estado Actual**: âœ… Totalmente funcional con Supabase Auth

---

## 6. MONETIZACIÃ“N - FASE 1 (IMPLEMENTADA)

### 6.1 Sistema de AfiliaciÃ³n

**Tablas Involucradas**:
- `affiliate_platforms`: 7 plataformas (Uber Eats, Glovo, Just Eat, Deliveroo, El Tenedor, Reserva Directa, Pedido Directo)
- `restaurant_affiliate_links`: Links de afiliaciÃ³n por restaurante
- `restaurant_discounts`: Descuentos activos con vigencia
- `affiliate_clicks`: Tracking completo de clicks

**Flujo de MonetizaciÃ³n**:

1. **Admin configura afiliaciÃ³n**:
   ```sql
   -- AÃ±adir link de Uber Eats para un restaurante
   INSERT INTO restaurant_affiliate_links 
     (restaurant_id, platform_id, affiliate_url, custom_priority)
   VALUES 
     ('uuid-restaurante', 'uuid-ubereats', 
      'https://ubereats.com/store/restaurante?ref=burgerank123', 10);
   
   -- AÃ±adir descuento exclusivo
   INSERT INTO restaurant_discounts 
     (restaurant_id, title, discount_type, discount_value, discount_code, is_exclusive)
   VALUES 
     ('uuid-restaurante', '15% exclusivo BurgeRank', 'percentage', 15, 'BURGERANK15', true);
   ```

2. **Usuario ve el CTA**:
   - Component `<AffiliateCTA restaurantId="..." />`
   - Muestra botÃ³n principal (plataforma con mayor prioridad)
   - Muestra badge de descuento (si existe)
   - Muestra links alternativos

3. **Usuario hace click**:
   - Tracking automÃ¡tico registra click
   - RedirecciÃ³n a affiliate_url
   - Request non-blocking (no afecta UX)

4. **ConversiÃ³n en plataforma**:
   - Usuario completa pedido en Uber Eats
   - Plataforma paga comisiÃ³n a BurgeRank (â‚¬1-â‚¬3)

**Optimizaciones**:
- Prioridad configurable
- CTA customizable por restaurante
- Tracking sin login
- Descuentos con fecha de caducidad automÃ¡tica

**ProyecciÃ³n de Ingresos**:
```
Escenario Conservador:
- 10,000 usuarios/mes
- 30% hacen click en CTA = 3,000 clicks
- 5% conversiÃ³n = 150 pedidos
- â‚¬2 comisiÃ³n promedio = â‚¬300/mes

Escenario Optimista:
- 50,000 usuarios/mes
- 40% clicks = 20,000 clicks
- 8% conversiÃ³n = 1,600 pedidos
- â‚¬2.50 promedio = â‚¬4,000/mes
```

### 6.2 Componentes de MonetizaciÃ³n

**`<AffiliateCTA />`**: Sticky CTA en pÃ¡gina de restaurante
- Mobile-first, sticky bottom
- BotÃ³n principal grande + links secundarios
- Badge de descuento si existe
- Tracking automÃ¡tico

**`<AffiliateCTAInline />`**: BotÃ³n compacto en cards de ranking
- BotÃ³n pequeÃ±o "Pedir"
- Solo se muestra si hay afiliaciÃ³n
- Tracking con source_burger_id

**Helpers** (`lib/affiliate/helpers.ts`):
- `getAffiliateCTAData(restaurantId)`: obtiene datos procesados
- `trackAffiliateClick(payload)`: registra click
- `generateSessionId()`: genera ID de sesiÃ³n Ãºnico

**APIs**:
- `GET /api/affiliate?restaurantId=X`: obtener datos
- `POST /api/affiliate/track`: registrar click (non-blocking)

---

## 7. SEGURIDAD Y AUTENTICACIÃ“N

### 7.1 Sistema de AutenticaciÃ³n

**Provider**: Supabase Auth

**Flujo**:
1. Registro â†’ `supabase.auth.signUp({ email, password })`
2. VerificaciÃ³n â†’ Email con magic link
3. Login â†’ `supabase.auth.signInWithPassword({ email, password })`
4. SesiÃ³n â†’ JWT almacenado en cookie httpOnly
5. Auto-creaciÃ³n de perfil â†’ Trigger en Supabase crea row en `users`

**Context**: `AuthContext` (app/contexts/AuthContext.tsx)
- Provee: authUser, userProfile, loading, signin(), signup(), logout()
- Utilizado en todas las pÃ¡ginas

### 7.2 Row Level Security (RLS)

**PolÃ­ticas implementadas**:

```sql
-- Users: ver propio perfil o perfiles pÃºblicos
CREATE POLICY "Users can view own profile" ON users
  FOR SELECT USING (auth.uid() = id);
  
CREATE POLICY "Users can view public profiles" ON users
  FOR SELECT USING (public_profile = TRUE);

-- Ratings: todos pueden ver, solo propietario puede editar/eliminar
CREATE POLICY "Anyone can view ratings" ON ratings
  FOR SELECT USING (TRUE);
  
CREATE POLICY "Users can create ratings" ON ratings
  FOR INSERT WITH CHECK (auth.uid() = user_id);

-- Burgers y Restaurants: lectura pÃºblica
CREATE POLICY "Anyone can view burgers" ON burgers FOR SELECT USING (TRUE);
CREATE POLICY "Anyone can view restaurants" ON restaurants FOR SELECT USING (TRUE);
```

### 7.3 Middleware de ProtecciÃ³n

**Archivo**: `middleware.ts`

**Rutas Protegidas**:
- `/profile/*` â†’ requiere autenticaciÃ³n
- `/rate/*` â†’ requiere autenticaciÃ³n
- `/admin/*` â†’ requiere autenticaciÃ³n + is_admin = true

**LÃ³gica**:
```typescript
if (!session && isProtectedRoute) {
  return NextResponse.redirect('/auth/signin');
}

if (isAdminRoute && !user.is_admin) {
  return NextResponse.redirect('/');
}
```

### 7.4 ProtecciÃ³n contra Gaming

**Sistema Anti-Gaming**:

1. **DetecciÃ³n de Patrones Sospechosos**:
   - MÃºltiples valoraciones del mismo usuario en poco tiempo
   - Ratings extremos sin comentario
   - IPs duplicadas
   - Cuentas creadas muy recientemente

2. **Weight de Valoraciones**:
   - ValoraciÃ³n verificada (con ticket): weight = 1.5
   - ValoraciÃ³n con foto: weight = 1.3
   - ValoraciÃ³n normal: weight = 1.0
   - ValoraciÃ³n sospechosa: weight = 0.5

3. **RevisiÃ³n Manual**:
   - Admin puede revisar y resolver

4. **LÃ­mite de Valoraciones**:
   - 1 valoraciÃ³n por burger por usuario (UNIQUE constraint)

---

## 8. MÃ‰TRICAS Y ANALYTICS (FUTURO)

### 8.1 KPIs de Producto

**AdquisiciÃ³n**:
- Nuevos usuarios/mes
- Fuente de trÃ¡fico
- Tasa de conversiÃ³n signup

**Engagement**:
- DAU / MAU
- Valoraciones por usuario
- Tiempo en sitio
- Retention Rate (D1, D7, D30)

**MonetizaciÃ³n**:
- CTR de affiliate links
- Tasa de conversiÃ³n (click â†’ pedido)
- Revenue per user (RPU)

**Contenido**:
- Burgers mÃ¡s valoradas
- Restaurantes mÃ¡s populares
- Ciudades mÃ¡s activas

### 8.2 Herramientas a Integrar

- Google Analytics 4
- Mixpanel/Amplitude
- Hotjar
- Sentry

---

## 9. ROADMAP

### âœ… Fase 0 - MVP (COMPLETADA)
- [x] AutenticaciÃ³n completa
- [x] Sistema de ranking con algoritmo avanzado
- [x] Wizard de valoraciÃ³n (5 pasos)
- [x] Sistema de puntos, badges y recompensas
- [x] Panel de admin completo
- [x] Carousel de burgers destacadas (Featured)
- [x] GestiÃ³n de 3 burgers destacadas desde panel admin
- [x] Responsive design (mobile-first)
- [x] Deployment en Vercel + Supabase

### âœ… Fase 1 - MonetizaciÃ³n BÃ¡sica (COMPLETADA)
- [x] Sistema de afiliaciÃ³n (7 plataformas)
- [x] Descuentos exclusivos con vigencia
- [x] Tracking de clicks
- [x] CTAs sticky en restaurantes
- [x] CTAs inline en ranking

### ğŸš§ Fase 2 - Growth (Q1 2026)
- [ ] SEO avanzado (meta tags dinÃ¡micos, sitemap, schema.org)
- [ ] Compartir en redes sociales (Open Graph, Twitter Cards)
- [ ] Sistema de referidos (invita amigos â†’ puntos bonus)
- [ ] Notificaciones push (nuevas burgers en tu ciudad)
- [ ] Email marketing (newsletter semanal)
- [ ] Blog integrado (SEO content)

### ğŸ“… Fase 3 - MonetizaciÃ³n Avanzada (Q2 2026)
- [ ] MembresÃ­a Premium (â‚¬4.99/mes)
  - Sin publicidad
  - Descuentos exclusivos adicionales
  - Acceso anticipado a nuevas burgers
  - Badge especial "Premium Member"
- [ ] Perfiles Premium para Restaurantes (â‚¬99-â‚¬299/mes)
  - PosiciÃ³n destacada en bÃºsquedas
  - Dashboard de analytics
  - GestiÃ³n de promociones
  - Respuesta a valoraciones
- [ ] Publicidad Display (native ads)
- [ ] Sponsored content

### ğŸ“… Fase 4 - ExpansiÃ³n (Q3 2026)
- [ ] App mÃ³vil nativa (React Native)
- [ ] InternacionalizaciÃ³n (Portugal, Francia, Italia)
- [ ] IntegraciÃ³n con Google Maps
- [ ] Sistema de reservas directo
- [ ] Marketplace de recompensas

### ğŸ“… Fase 5 - Comunidad (Q4 2026)
- [ ] Perfiles pÃºblicos con followers
- [ ] Feed social (estilo Instagram)
- [ ] Listas personalizadas
- [ ] Challenges comunitarios
- [ ] Eventos y meetups de burgers

---

## 10. VENTAJAS COMPETITIVAS

### 10.1 vs Google Maps / TripAdvisor
- âœ… **EspecializaciÃ³n**: Solo hamburguesas
- âœ… **Ranking algorÃ­tmico**: No manipulable, matemÃ¡ticamente justo
- âœ… **ValoraciÃ³n granular**: 5 componentes (pan, carne, toppings, salsa, general)
- âœ… **GamificaciÃ³n**: Puntos, badges, categorÃ­as â†’ mayor engagement
- âœ… **Comunidad**: Identidad compartida de "burger lovers"

### 10.2 vs Redes Sociales (Instagram/TikTok)
- âœ… **OrganizaciÃ³n**: Ranking estructurado vs contenido disperso
- âœ… **Objetividad**: Algoritmo vs influencers pagados
- âœ… **BÃºsqueda**: Filtros avanzados vs hashtags imprecisos
- âœ… **Permanencia**: Base de datos persistente vs feed efÃ­mero

### 10.3 vs Blogs de Comida
- âœ… **ActualizaciÃ³n**: Valoraciones en tiempo real vs artÃ­culos desactualizados
- âœ… **Colaborativo**: MÃºltiples opiniones vs 1 autor
- âœ… **Interactividad**: Usuarios pueden valorar vs lectura pasiva
- âœ… **Cobertura**: 120+ burgers vs 10-20 por blog

---

## 11. RIESGOS Y MITIGACIONES

| Riesgo | Probabilidad | Impacto | MitigaciÃ³n |
|--------|--------------|---------|------------|
| **Fake reviews / gaming** | Media | Alto | Sistema anti-gaming, verificaciÃ³n con tickets, revisiÃ³n manual |
| **Dependencia de afiliados** | Media | Medio | Diversificar fuentes de ingreso (Premium, ads) |
| **Competencia de apps grandes** | Baja | Alto | Nicho especÃ­fico, comunidad fuerte, especializaciÃ³n |
| **Escalabilidad tÃ©cnica** | Baja | Medio | Supabase y Vercel escalan automÃ¡ticamente |
| **Costes de adquisiciÃ³n altos** | Media | Medio | Growth orgÃ¡nico (SEO, social), sistema de referidos |
| **RegulaciÃ³n GDPR** | Baja | Medio | RLS, consentimiento explÃ­cito, polÃ­tica de privacidad |
| **Cambios en APIs de afiliados** | Media | Bajo | AbstracciÃ³n en cÃ³digo, URLs configurables por admin |

---

## 12. EQUIPO Y RECURSOS NECESARIOS

### Actual (Fundador Solo)
- âœ… Desarrollador Full-Stack (tÃº)

### Escala Inicial (0-10k usuarios)
- Community Manager (part-time)
- Moderador de contenido (part-time)

### Escala Media (10k-100k usuarios)
- CTO/Lead Developer (full-time)
- Marketing Manager (full-time)
- Community Manager (full-time)
- 2 Moderadores (part-time)
- DiseÃ±ador UI/UX (freelance)

### Escala Grande (100k+ usuarios)
- Equipo de desarrollo (4-6 devs)
- Equipo de marketing (3-4 personas)
- Equipo de operaciones (2-3 personas)
- Data Analyst
- Legal/Compliance

---

## 13. CONCLUSIÃ“N

**BurgeRank** es una plataforma tÃ©cnicamente sÃ³lida, con un modelo de negocio escalable y una propuesta de valor clara. La Fase 1 de monetizaciÃ³n estÃ¡ implementada y lista para generar ingresos desde el dÃ­a 1.

**Fortalezas clave**:
- âœ… Producto funcional y completo
- âœ… Stack moderno y escalable
- âœ… Algoritmo de ranking justo y transparente
- âœ… GamificaciÃ³n para retenciÃ³n
- âœ… MonetizaciÃ³n sin comprometer UX
- âœ… Nicho especÃ­fico con poca competencia directa

**PrÃ³ximos pasos inmediatos**:
1. Lanzar y obtener primeros 100 usuarios
2. Negociar programas de afiliaciÃ³n con plataformas
3. Contactar 10-20 restaurantes para onboarding
4. SEO bÃ¡sico (meta tags, sitemap)
5. CampaÃ±a inicial en redes sociales

**Viabilidad**: Alta. El proyecto estÃ¡ listo para producciÃ³n y puede comenzar a generar ingresos en el primer mes de operaciÃ³n.

---

**Documento generado**: 27 de diciembre de 2025  
**VersiÃ³n**: 1.0  
**Autor**: AnÃ¡lisis completo del proyecto BurgeRank
